# Changes (2026-01-21)

This package contains launch-readiness cleanup + flow fixes.

## App flow fixes

### Service-area onboarding (ZIP → Hub assignment / waitlist)
- Added `app/(auth)/service-area.tsx` to capture the user ZIP and set their service area.
  - Uses `zip_codes` → (lat,lng) and `get_nearest_hub` to preview coverage.
  - Persists via RPC `set_my_service_area(...)` to ensure the user is linked to a hub and (when out of range) added to waitlist.
- Added `app/out-of-service.tsx` (missing route referenced by `app/index.tsx`).
  - Gives a clean, user-facing path to set/change ZIP and join waitlist.

### Hub coverage map + counts
- Added `app/hubs.tsx` (route: `/hubs`).
  - Shows hubs on a map with active-radius rings.
  - Shows aggregated counts per hub (mechanics/customers) without exposing mechanic locations.
- Linked to this screen from:
  - Customer Explore tab
  - Mechanic Profile tab

## Admin improvements

### Escrow capture control
- Admin Job Detail now shows escrow status fields and exposes a **Capture Payment** button when the payment is authorized and the job is completed.
  - Calls the `capture-contract-payment` edge function and refreshes the job detail.

## Supabase / migrations cleanup

### Migrations squashed
- `supabase/migrations` reduced from 180+ files to **one** baseline:
  - `supabase/migrations/0001_baseline.sql`
- New `supabase/migrations/README.md` explains how to add future incremental migrations.

